2024-12-28 13:05:27 | Analysis | INFO | Environment setup complete.
2024-12-28 13:05:27 | Analysis | INFO | Output directory configured: output
2024-12-28 13:05:27 | Analysis | INFO | Successfully loaded the marketing_data dataset from data/bank-additional.csv
2024-12-28 13:05:27 | Analysis | INFO | === marketing_data Dataset Information ===
2024-12-28 13:05:27 | Analysis | INFO | Shape: (4119, 21)
2024-12-28 13:05:27 | Analysis | INFO | Number of Null Values: 0
2024-12-28 13:05:27 | Analysis | INFO | Data types:
object     11
int64       5
float64     5
Name: count, dtype: int64
2024-12-28 13:05:27 | Analysis | INFO | Descriptive Statistics (mean, std, min, max):
            age     duration   campaign       pdays  previous  emp.var.rate  \
mean  40.113620   256.788055   2.537266  960.422190  0.190337      0.084972   
std   10.313362   254.703736   2.568159  191.922786  0.541788      1.563114   
min   18.000000     0.000000   1.000000    0.000000  0.000000     -3.400000   
max   88.000000  3643.000000  35.000000  999.000000  6.000000      1.400000   

      cons.price.idx  cons.conf.idx  euribor3m  nr.employed  
mean       93.579704     -40.499102   3.621356  5166.481695  
std         0.579349       4.594578   1.733591    73.667904  
min        92.201000     -50.800000   0.635000  4963.600000  
max        94.767000     -26.900000   5.045000  5228.100000  
2024-12-28 13:05:27 | Analysis | INFO | Five Random Records:
      age          job   marital          education  default housing loan  \
2602   53       admin.    single            unknown  unknown      no   no   
457    45   management   married  university.degree       no     yes   no   
807    29   technician   married  university.degree       no     yes  yes   
2770   43  blue-collar    single            unknown  unknown      no   no   
2711   43   unemployed  divorced           basic.9y       no      no   no   

        contact month day_of_week  ...  campaign  pdays  previous  \
2602   cellular   jul         tue  ...         1    999         0   
457    cellular   jul         thu  ...         1    999         0   
807    cellular   aug         wed  ...         2    999         0   
2770  telephone   may         wed  ...         3    999         0   
2711   cellular   jul         mon  ...         7    999         0   

         poutcome emp.var.rate  cons.price.idx  cons.conf.idx  euribor3m  \
2602  nonexistent          1.4          93.918          -42.7      4.961   
457   nonexistent          1.4          93.918          -42.7      4.968   
807   nonexistent          1.4          93.444          -36.1      4.964   
2770  nonexistent          1.1          93.994          -36.4      4.857   
2711  nonexistent          1.4          93.918          -42.7      4.962   

      nr.employed   y  
2602       5228.1  no  
457        5228.1  no  
807        5228.1  no  
2770       5191.0  no  
2711       5228.1  no  

[5 rows x 21 columns]

2024-12-28 13:05:27 | Analysis | INFO | 
Descriptive Statistics for age:
{'count': 4119.0, 'mean': 40.11361981063365, 'std': 10.313361547199813, 'min': 18.0, '25%': 32.0, '50%': 38.0, '75%': 47.0, 'max': 88.0}

2024-12-28 13:05:27 | Analysis | INFO | Histogram for age saved to output/num_age_distribution.png
2024-12-28 13:05:27 | Analysis | INFO | 
Descriptive Statistics for duration:
{'count': 4119.0, 'mean': 256.7880553532411, 'std': 254.70373612073678, 'min': 0.0, '25%': 103.0, '50%': 181.0, '75%': 317.0, 'max': 3643.0}

2024-12-28 13:05:27 | Analysis | INFO | Histogram for duration saved to output/num_duration_distribution.png
2024-12-28 13:05:27 | Analysis | INFO | 
Descriptive Statistics for campaign:
{'count': 4119.0, 'mean': 2.537266326778344, 'std': 2.568159237578138, 'min': 1.0, '25%': 1.0, '50%': 2.0, '75%': 3.0, 'max': 35.0}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for campaign saved to output/num_campaign_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for pdays:
{'count': 4119.0, 'mean': 960.4221898519058, 'std': 191.92278580077644, 'min': 0.0, '25%': 999.0, '50%': 999.0, '75%': 999.0, 'max': 999.0}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for pdays saved to output/num_pdays_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for previous:
{'count': 4119.0, 'mean': 0.19033746054867687, 'std': 0.5417883234290308, 'min': 0.0, '25%': 0.0, '50%': 0.0, '75%': 0.0, 'max': 6.0}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for previous saved to output/num_previous_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for emp.var.rate:
{'count': 4119.0, 'mean': 0.08497208060208788, 'std': 1.5631144559116763, 'min': -3.4, '25%': -1.8, '50%': 1.1, '75%': 1.4, 'max': 1.4}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for emp.var.rate saved to output/num_emp.var.rate_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for cons.price.idx:
{'count': 4119.0, 'mean': 93.57970429715951, 'std': 0.5793488049889662, 'min': 92.201, '25%': 93.075, '50%': 93.749, '75%': 93.994, 'max': 94.767}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for cons.price.idx saved to output/num_cons.price.idx_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for cons.conf.idx:
{'count': 4119.0, 'mean': -40.49910172371935, 'std': 4.594577506837543, 'min': -50.8, '25%': -42.7, '50%': -41.8, '75%': -36.4, 'max': -26.9}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for cons.conf.idx saved to output/num_cons.conf.idx_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for euribor3m:
{'count': 4119.0, 'mean': 3.621355668851663, 'std': 1.7335912227013557, 'min': 0.635, '25%': 1.334, '50%': 4.857, '75%': 4.961, 'max': 5.045}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for euribor3m saved to output/num_euribor3m_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Descriptive Statistics for nr.employed:
{'count': 4119.0, 'mean': 5166.481694586065, 'std': 73.66790355721253, 'min': 4963.6, '25%': 5099.1, '50%': 5191.0, '75%': 5228.1, 'max': 5228.1}

2024-12-28 13:05:28 | Analysis | INFO | Histogram for nr.employed saved to output/num_nr.employed_distribution.png
2024-12-28 13:05:28 | Analysis | INFO | 
Distribution for job:
               Count  Percentage
job                             
admin.          1012       24.57
blue-collar      884       21.46
technician       691       16.78
services         393        9.54
management       324        7.87
retired          166        4.03
self-employed    159        3.86
entrepreneur     148        3.59
unemployed       111        2.69
housemaid        110        2.67
student           82        1.99
unknown           39        0.95

2024-12-28 13:05:28 | Analysis | INFO | Relationship plot for job saved to output/relationship_job_target.png
2024-12-28 13:05:28 | Analysis | INFO | 
Distribution for marital:
          Count  Percentage
marital                    
married    2509       60.91
single     1153       27.99
divorced    446       10.83
unknown      11        0.27

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for marital saved to output/relationship_marital_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for education:
                     Count  Percentage
education                             
university.degree     1264       30.69
high.school            921       22.36
basic.9y               574       13.94
professional.course    535       12.99
basic.4y               429       10.42
basic.6y               228        5.54
unknown                167        4.05
illiterate               1        0.02

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for education saved to output/relationship_education_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for default:
         Count  Percentage
default                   
no        3315       80.48
unknown    803       19.50
yes          1        0.02

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for default saved to output/relationship_default_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for housing:
         Count  Percentage
housing                   
yes       2175       52.80
no        1839       44.65
unknown    105        2.55

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for housing saved to output/relationship_housing_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for loan:
         Count  Percentage
loan                      
no        3349       81.31
yes        665       16.14
unknown    105        2.55

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for loan saved to output/relationship_loan_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for contact:
           Count  Percentage
contact                     
cellular    2652       64.38
telephone   1467       35.62

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for contact saved to output/relationship_contact_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for month:
       Count  Percentage
month                   
may     1378       33.45
jul      711       17.26
aug      636       15.44
jun      530       12.87
nov      446       10.83
apr      215        5.22
oct       69        1.68
sep       64        1.55
mar       48        1.17
dec       22        0.53

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for month saved to output/relationship_month_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for day_of_week:
             Count  Percentage
day_of_week                   
thu            860       20.88
mon            855       20.76
tue            841       20.42
wed            795       19.30
fri            768       18.65

2024-12-28 13:05:29 | Analysis | INFO | Relationship plot for day_of_week saved to output/relationship_day_of_week_target.png
2024-12-28 13:05:29 | Analysis | INFO | 
Distribution for poutcome:
             Count  Percentage
poutcome                      
nonexistent   3523       85.53
failure        454       11.02
success        142        3.45

2024-12-28 13:05:30 | Analysis | INFO | Relationship plot for poutcome saved to output/relationship_poutcome_target.png
2024-12-28 13:05:30 | Analysis | INFO | Target variable distribution saved to output/class_distribution.png
2024-12-28 13:05:30 | Analysis | INFO | Correlation matrix saved to output/correlation_matrix.png
2024-12-28 13:05:30 | Analysis | INFO | X_train shape: (5868, 53)
2024-12-28 13:05:30 | Analysis | INFO | X_test shape: (1468, 53)
2024-12-28 13:05:30 | Analysis | INFO | y_train distribution:
y
1    2934
0    2934
Name: count, dtype: int64
2024-12-28 13:05:30 | Analysis | INFO | y_test distribution:
y
1    734
0    734
Name: count, dtype: int64
2024-12-28 13:05:30 | Analysis | INFO | Fitting Dummy Classifier as a baseline...
2024-12-28 13:05:30 | Analysis | INFO | Dummy Classifier Baseline Accuracy: 0.5000
2024-12-28 13:05:30 | Analysis | INFO | Classification Report (Dummy):
              precision    recall  f1-score   support

           0     0.5000    1.0000    0.6667       734
           1     0.0000    0.0000    0.0000       734

    accuracy                         0.5000      1468
   macro avg     0.2500    0.5000    0.3333      1468
weighted avg     0.2500    0.5000    0.3333      1468

2024-12-28 13:05:30 | Analysis | INFO | Training Logistic Regression...
2024-12-28 13:05:30 | Analysis | INFO | Logistic Regression Classification Report:
              precision    recall  f1-score   support

           0     0.8837    0.8801    0.8819       734
           1     0.8806    0.8842    0.8824       734

    accuracy                         0.8822      1468
   macro avg     0.8822    0.8822    0.8822      1468
weighted avg     0.8822    0.8822    0.8822      1468

2024-12-28 13:05:30 | Analysis | INFO | Confusion matrix for Logistic Regression saved to output/confusion_matrix_Logistic Regression.png
2024-12-28 13:05:30 | Analysis | INFO | Logistic Regression Train Accuracy: 0.8782
2024-12-28 13:05:30 | Analysis | INFO | Logistic Regression Test Accuracy: 0.8822
2024-12-28 13:05:30 | Analysis | INFO | Training Logistic Regression...
2024-12-28 13:05:30 | Analysis | INFO | Logistic Regression Classification Report:
              precision    recall  f1-score   support

           0     0.8837    0.8801    0.8819       734
           1     0.8806    0.8842    0.8824       734

    accuracy                         0.8822      1468
   macro avg     0.8822    0.8822    0.8822      1468
weighted avg     0.8822    0.8822    0.8822      1468

2024-12-28 13:05:31 | Analysis | INFO | Confusion matrix for Logistic Regression saved to output/confusion_matrix_Logistic Regression.png
2024-12-28 13:05:31 | Analysis | INFO | Training Decision Tree...
2024-12-28 13:05:31 | Analysis | INFO | Decision Tree Classification Report:
              precision    recall  f1-score   support

           0     1.0000    0.9441    0.9713       734
           1     0.9471    1.0000    0.9728       734

    accuracy                         0.9721      1468
   macro avg     0.9735    0.9721    0.9720      1468
weighted avg     0.9735    0.9721    0.9720      1468

2024-12-28 13:05:31 | Analysis | INFO | Confusion matrix for Decision Tree saved to output/confusion_matrix_Decision Tree.png
2024-12-28 13:05:31 | Analysis | INFO | Training KNN...
2024-12-28 13:05:31 | Analysis | INFO | KNN Classification Report:
              precision    recall  f1-score   support

           0     0.9858    0.8542    0.9153       734
           1     0.8714    0.9877    0.9259       734

    accuracy                         0.9210      1468
   macro avg     0.9286    0.9210    0.9206      1468
weighted avg     0.9286    0.9210    0.9206      1468

2024-12-28 13:05:31 | Analysis | INFO | Confusion matrix for KNN saved to output/confusion_matrix_KNN.png
2024-12-28 13:05:31 | Analysis | INFO | Training SVM...
2024-12-28 13:05:33 | Analysis | INFO | SVM Classification Report:
              precision    recall  f1-score   support

           0     0.9666    0.8665    0.9138       734
           1     0.8790    0.9700    0.9223       734

    accuracy                         0.9183      1468
   macro avg     0.9228    0.9183    0.9180      1468
weighted avg     0.9228    0.9183    0.9180      1468

2024-12-28 13:05:33 | Analysis | INFO | Confusion matrix for SVM saved to output/confusion_matrix_SVM.png
2024-12-28 13:05:33 | Analysis | INFO | 
Comparison of Default Models:
2024-12-28 13:05:33 | Analysis | INFO | 
+----+---------------------+------------------+-------------+------------+
|    | Model               |   Train Time (s) |   Train Acc |   Test Acc |
|----+---------------------+------------------+-------------+------------|
|  0 | Logistic Regression |             0.07 |      0.8782 |     0.8822 |
|  1 | Decision Tree       |             0.02 |      1      |     0.9721 |
|  2 | KNN                 |             0    |      0.945  |     0.921  |
|  3 | SVM                 |             1.3  |      0.9322 |     0.9183 |
+----+---------------------+------------------+-------------+------------+
2024-12-28 13:05:33 | Analysis | INFO | 
Starting hyperparameter tuning for Logistic Regression ...
2024-12-28 13:05:35 | Analysis | INFO | Best Params for Logistic Regression: {'C': 10, 'penalty': 'l2', 'solver': 'liblinear'}
2024-12-28 13:05:35 | Analysis | INFO | Train Accuracy: 0.8805
2024-12-28 13:05:35 | Analysis | INFO | Test Accuracy: 0.8815
2024-12-28 13:05:35 | Analysis | INFO | Test ROC AUC: 0.9438
2024-12-28 13:05:35 | Analysis | INFO | GridSearch took 1.81s
2024-12-28 13:05:35 | Analysis | INFO | 
Starting hyperparameter tuning for Decision Tree ...
2024-12-28 13:05:36 | Analysis | INFO | Best Params for Decision Tree: {'max_depth': None, 'min_samples_leaf': 1, 'min_samples_split': 2}
2024-12-28 13:05:36 | Analysis | INFO | Train Accuracy: 1.0000
2024-12-28 13:05:36 | Analysis | INFO | Test Accuracy: 0.9721
2024-12-28 13:05:36 | Analysis | INFO | Test ROC AUC: 0.9721
2024-12-28 13:05:36 | Analysis | INFO | GridSearch took 0.53s
2024-12-28 13:05:36 | Analysis | INFO | 
Starting hyperparameter tuning for KNN ...
2024-12-28 13:05:36 | Analysis | INFO | Best Params for KNN: {'n_neighbors': 3, 'weights': 'distance'}
2024-12-28 13:05:36 | Analysis | INFO | Train Accuracy: 1.0000
2024-12-28 13:05:36 | Analysis | INFO | Test Accuracy: 0.9435
2024-12-28 13:05:36 | Analysis | INFO | Test ROC AUC: 0.9685
2024-12-28 13:05:36 | Analysis | INFO | GridSearch took 0.20s
2024-12-28 13:05:36 | Analysis | INFO | 
Starting hyperparameter tuning for SVM ...
2024-12-28 13:05:55 | Analysis | INFO | Best Params for SVM: {'C': 10, 'gamma': 1, 'kernel': 'rbf'}
2024-12-28 13:05:56 | Analysis | INFO | Train Accuracy: 1.0000
2024-12-28 13:05:56 | Analysis | INFO | Test Accuracy: 0.9986
2024-12-28 13:05:56 | Analysis | INFO | Test ROC AUC: 1.0000
2024-12-28 13:05:56 | Analysis | INFO | GridSearch took 18.54s
2024-12-28 13:05:57 | Analysis | INFO | 
Tuning Results:
2024-12-28 13:05:57 | Analysis | INFO | 
+----+---------------------+------------+-------------+------------+-----------+--------------------------------------------------------------------+
|    | Model               |   Time (s) |   Train Acc |   Test Acc |   ROC AUC | Best Params                                                        |
|----+---------------------+------------+-------------+------------+-----------+--------------------------------------------------------------------|
|  0 | Logistic Regression |       1.81 |    0.880539 |   0.881471 |  0.94377  | {'C': 10, 'penalty': 'l2', 'solver': 'liblinear'}                  |
|  1 | Decision Tree       |       0.53 |    1        |   0.972071 |  0.972071 | {'max_depth': None, 'min_samples_leaf': 1, 'min_samples_split': 2} |
|  2 | KNN                 |       0.2  |    1        |   0.94346  |  0.968451 | {'n_neighbors': 3, 'weights': 'distance'}                          |
|  3 | SVM                 |      18.54 |    1        |   0.998638 |  1        | {'C': 10, 'gamma': 1, 'kernel': 'rbf'}                             |
+----+---------------------+------------+-------------+------------+-----------+--------------------------------------------------------------------+
